---
phase: 03-auzoom-structural-compliance
plan: 01
type: execute
---

<objective>
Run auzoom_validate on entire codebase to identify all structural violations (≤50 line functions, ≤250 line modules, ≤7 files per directory).

Purpose: Document how well the implementation follows its own structural guidelines and identify any violations that may impact progressive disclosure effectiveness.
Output: Comprehensive validation report documenting all violations with severity classification and evidence.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-auzoom-core-verification/02-04-SUMMARY.md
@auzoom/src/auzoom/core/validator.py

**Tech stack available:**
- AuZoom validator with CodeValidator class (FUNCTION_MAX_LINES=50, MODULE_MAX_LINES=250, DIR_MAX_FILES=7)
- Violation dataclass with file, line, type, severity, message, current, limit fields
- validate_file(), validate_directory(), validate_project() methods
- format_report() for readable output
- Audit infrastructure from Phase 1 (AuditTest, evidence logging, reporting)

**Established patterns:**
- Audit test structure (test class → evidence collection → markdown report)
- Evidence logging with EvidenceType enum
- Comprehensive reports with findings, impact assessment, recommendations
- Real codebase testing methodology from Phase 2

**Constraining decisions:**
- Audit as separate milestone: Existing implementation is source of truth for validation
- Fix-implementation-first: Violations are documentation of current state, not failures
- Evidence-based findings: All violations must be documented with file/line references
- Comprehensive scope: Validate entire project (auzoom/, orchestrator/, audit/)

**From Phase 2:**
- Progressive disclosure validated for single files (95.32% skeleton reduction)
- Large files show exceptional savings (96.89%)
- Structural compliance may affect these savings if functions/modules too large
- Validation framework established (test → evidence → report pattern)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create structural validation test</name>
  <files>audit/tests/test_structural_compliance.py</files>
  <action>Create test using AuditTest base class to validate entire project structure. Import CodeValidator from auzoom.core.validator. Run validator.validate_project() on project root (/Users/dhirajd/Documents/claude). Collect all violations with file paths, line numbers, violation types (function_too_long, module_too_long, dir_too_many_files), severity levels, and current vs limit values. Log evidence for each violation type category with counts, examples, and severity breakdown. Use EvidenceType.COMPLIANCE_CHECK for evidence entries. Include validation scope (files checked, directories scanned, total lines analyzed) in evidence.</action>
  <verify>pytest audit/tests/test_structural_compliance.py passes and produces evidence file audit/evidence/structural_compliance_YYYYMMDD_HHMMSS.jsonl</verify>
  <done>Test executes successfully, all violations documented in evidence with file/line references, evidence file contains violation counts by type and severity</done>
</task>

<task type="auto">
  <name>Task 2: Execute validation and analyze violations</name>
  <files>audit/reports/03-01-structural-compliance.md</files>
  <action>Run pytest to execute test and collect violations. Parse evidence file to analyze violation patterns: (1) Count by type (function_too_long, module_too_long, dir_too_many_files), (2) Count by severity (error vs warning), (3) Identify worst offenders (files/functions with highest over-limit percentages), (4) Calculate compliance rate (compliant files / total files checked), (5) Segment by codebase area (auzoom/, orchestrator/, audit/). Create comprehensive markdown report at audit/reports/03-01-structural-compliance.md with: Executive Summary (overall compliance rate, total violations), Detailed Findings (violations by type with examples), Worst Offenders table (file/function, current, limit, over-limit %), Compliance by Area (breakdown by subsystem), and appendix with full violation list. Include visual indicators (✓/❌) for compliance status.</action>
  <verify>Report exists at audit/reports/03-01-structural-compliance.md with all sections populated, compliance rate calculated, worst offenders identified with file:line references</verify>
  <done>Report complete with quantified findings, violations categorized by type/severity, compliance rate documented, worst offenders identified, ready for impact assessment in 03-02</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Test executes and collects all violations from project
- [ ] Evidence file contains violation data with file/line references
- [ ] Report documents compliance rate and violation patterns
- [ ] Worst offenders identified with specific file:line:function references
- [ ] Validation covers auzoom/, orchestrator/, and audit/ directories
</verification>

<success_criteria>

- All tasks completed
- Structural validation test exists and executes successfully
- Evidence logged with violation counts, types, severities
- Comprehensive report with compliance rate and worst offenders
- All violations documented with actionable file/line references
- Ready for impact assessment in Plan 03-02
  </success_criteria>

<output>
After completion, create `.planning/phases/03-auzoom-structural-compliance/03-01-SUMMARY.md`:

---
phase: 03-auzoom-structural-compliance
plan: 01
subsystem: auzoom-structured-code
tags: [structural-validation, compliance-audit, code-quality, auzoom-guidelines]

# Dependency graph
requires:
  - phase: 02-auzoom-core-verification
    plan: 04
    provides: Real codebase token savings measurement, validation patterns
provides:
  - Structural compliance validation for entire project
  - Violation counts by type (function_too_long, module_too_long, dir_too_many_files)
  - Compliance rate calculation (compliant files / total files)
  - Worst offenders identification with file/line references
affects: [03-02-impact-assessment, 12-critical-fixes]

# Tech tracking
tech-stack:
  added: []
  patterns: [structural-validation, compliance-auditing]

key-files:
  created: [audit/tests/test_structural_compliance.py, audit/reports/03-01-structural-compliance.md]
  modified: []

key-decisions:
  - "[Compliance rate X%] - Y violations found across Z files"
  - "Worst offender types: [list violation types sorted by frequency]"
  - "Critical areas: [subsystems with most violations]"

patterns-established:
  - "Project-wide structural validation with CodeValidator"
  - "Violation categorization by type, severity, and subsystem"
  - "Compliance rate calculation methodology"

issues-created: []

# Metrics
duration: [X]min
completed: [date]
---

# Phase 3 Plan 01: Structural Compliance Validation Summary

**[One-liner about compliance rate and key findings]**

## Accomplishments

- Validated entire project structure using CodeValidator
- Documented [X] violations across [Y] files
- Calculated [Z]% overall compliance rate
- Identified worst offenders and compliance patterns

## Files Created/Modified

- `audit/tests/test_structural_compliance.py` - Structural validation test
- `audit/evidence/structural_compliance_YYYYMMDD_HHMMSS.jsonl` - Violation evidence
- `audit/reports/03-01-structural-compliance.md` - Compliance findings report

## Decisions Made

[Compliance findings and severity assessment]

## Issues Encountered

[Any issues or "None"]

## Next Phase Readiness

Ready for Plan 03-02: Impact Assessment (assess if violations hurt token savings)
</output>
